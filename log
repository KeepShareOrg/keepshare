{
  "configs": {
    "access_token_expiration": "2h",
    "confirm_email_html_template": "<div style=\"padding: 16px; margin: 0 auto; width: fit-content;\"> <div style=\"display: flex; align-items: center; gap: 2px;\"> <img alt=\"KeepShare logo\" width=\"40\" src=\"data:image/png;base64,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\" /> <span style=\"font-size: 15px; font-weight: 700;\">KeepShare</span></div> <h2 style=\"margin: 30px 0;\">Verify your email address</h2> <p style=\"margin: 0 0 21px 0;\">To protect the security of your KeepShare account, please verify that this is your email address.</p> <a style=\"display: inline-block; width: 180px; height: 30px; text-align: center; line-height: 30px; text-decoration: none; color: #fff; border-radius: 4px; background: #5B67EA;\" href=\"%s\">Verify Email Address</a> <p style=\"opacity: 0.5; margin: 36px 0 0 0;\">This link will expire in 3 days. If you did not make this request, please disregard this email.</p></div>",
    "confirm_email_text_template": "Verify your email address. To protect the security of your KeepShare account, please verify that this is your email address. Verify email address: %s. This link will expire in 3 days. If you did not make this request, please disregard this email.",
    "console_proxy_url": "",
    "db_mysql": "root:admin@(127.0.0.1:3306)/keepshare?charset=utf8mb4&parseTime=True&loc=Local",
    "db_redis": "redis://localhost:6379?db=10&dial_timeout=2s&read_timeout=2s&max_retries=2",
    "email": {
      "email": "keepshare.org@gmail.com",
      "password": "ynafgcrapsjjkbbb",
      "port": 587,
      "server": "smtp.gmail.com",
      "username": "KeepShare"
    },
    "google_recaptcha_secret": "6Lf4kkQoAAAAAD8rTAklNtncSsSmiE_B9HlAk2PB",
    "host_default": "pikpak",
    "listen_http": ":8080",
    "listen_https": "",
    "log_access_output": "",
    "log_backups": 10,
    "log_format": "json",
    "log_level": "debug",
    "log_output": "",
    "log_pretty": true,
    "mail_server": "https://mail.keepshare.org",
    "pikpak": {
      "master_buffer_interval": "10s",
      "master_buffer_size": 2,
      "worker_buffer_interval": "1s",
      "worker_buffer_size": 5
    },
    "refresh_token_expiration": "168h",
    "reset_password_verify_email_html_template": "<h1>your html version verification code: %s</h1>",
    "reset_password_verify_email_text_template": "your text version verification code: %s",
    "root_domain": "localhost",
    "token_secret_key": "secret_key",
    "verification_code_length": 6,
    "verification_retry_count_limit": 10,
    "verify_code_expires": "10m",
    "verify_email_link_expires": "72h",
    "verify_email_link_salt": "B0&-2v-gHhCT[R!Pnr>v5^j*whE=jc48"
  },
  "file": "server/root.go:46",
  "func": "server.Start",
  "level": "debug",
  "msg": "viper all settings",
  "time": "2024-04-17T16:01:18.355+08:00"
}
{
  "file": "server/root.go:71",
  "func": "server.Start",
  "level": "info",
  "msg": "loaded languages:[en]",
  "time": "2024-04-17T16:01:18.357+08:00"
}
{
  "file": "log/log.go:162",
  "func": "log.(*Logger).Info",
  "level": "info",
  "msg": "Starting processing",
  "time": "2024-04-17T16:01:18.363+08:00"
}
{
  "file": "log/log.go:162",
  "func": "log.(*Logger).Info",
  "level": "info",
  "msg": "Send signal TSTP to stop processing new tasks",
  "time": "2024-04-17T16:01:18.363+08:00"
}
{
  "file": "log/log.go:162",
  "func": "log.(*Logger).Info",
  "level": "info",
  "msg": "Send signal TERM or INT to terminate the process",
  "time": "2024-04-17T16:01:18.363+08:00"
}
{
  "file": "gormutil/logger.go:97",
  "func": "gormutil.(*gormLogger).Trace",
  "latency_ms": 1.801,
  "level": "debug",
  "msg": "",
  "rows": 0,
  "sql": "SELECT * FROM `pikpak_file` WHERE `status` in ('PHASE_TYPE_RUNNING', 'PHASE_TYPE_PENDING') AND (`updated_at`, `auto_id`) > ('1970-01-01 00:00:00 +0000 UTC', '0') AND `created_at`>'2024-04-15 16:01:18' AND TIMESTAMPDIFF(SECOND, `updated_at`, NOW())*60 > TIMESTAMPDIFF(SECOND, `created_at`, `updated_at`) ORDER BY updated_at LIMIT 10000",
  "time": "2024-04-17T16:01:18.365+08:00"
}
{
  "file": "api/file.go:411",
  "func": "api.(*API).triggerFilesFromDB",
  "level": "debug",
  "msg": "current internal trigger chan length: 0, from db length: 0",
  "time": "2024-04-17T16:01:18.365+08:00"
}
{
  "file": "gormutil/logger.go:97",
  "func": "gormutil.(*gormLogger).Trace",
  "latency_ms": 2.514,
  "level": "debug",
  "msg": "",
  "rows": 0,
  "sql": "SELECT * FROM `pikpak_file` WHERE `pikpak_file`.`status` IN ('PHASE_TYPE_RUNNING','PHASE_TYPE_PENDING') AND `pikpak_file`.`created_at` > '2024-04-17 15:51:18.363' ORDER BY `pikpak_file`.`created_at` LIMIT 10000",
  "time": "2024-04-17T16:01:18.365+08:00"
}
{
  "file": "gormutil/logger.go:97",
  "func": "gormutil.(*gormLogger).Trace",
  "latency_ms": 3.742,
  "level": "debug",
  "msg": "",
  "rows": 1,
  "sql": "SELECT count(*) FROM `pikpak_worker_account` WHERE `pikpak_worker_account`.`master_user_id` = '' AND `pikpak_worker_account`.`premium_expiration` > '2024-04-17 16:01:18.363'",
  "time": "2024-04-17T16:01:18.367+08:00"
}
{
  "file": "account/buffer.go:206",
  "func": "account.(*Manager).checkPremiumWorkerBuffer.func1",
  "level": "debug",
  "msg": "not used premium worker count: 0 10",
  "time": "2024-04-17T16:01:18.367+08:00"
}
{
  "file": "gormutil/logger.go:97",
  "func": "gormutil.(*gormLogger).Trace",
  "latency_ms": 3.828,
  "level": "debug",
  "msg": "",
  "rows": 0,
  "sql": "select * from `keepshare_shared_link` where state = 'CREATED' and original_link_hash in (select original_link_hash from `pikpak_file` where status = 'PHASE_TYPE_COMPLETE' AND updated_at > '2024-04-16 16:01:18')",
  "time": "2024-04-17T16:01:18.367+08:00"
}
{
  "file": "gormutil/logger.go:97",
  "func": "gormutil.(*gormLogger).Trace",
  "latency_ms": 0.776,
  "level": "debug",
  "msg": "",
  "rows": 1,
  "sql": "SELECT * FROM `pikpak_worker_account` WHERE `pikpak_worker_account`.`master_user_id` = '' AND `pikpak_worker_account`.`premium_expiration` < '2024-04-17 16:01:18.367' LIMIT 1",
  "time": "2024-04-17T16:01:18.368+08:00"
}
{
  "file": "gormutil/logger.go:97",
  "func": "gormutil.(*gormLogger).Trace",
  "latency_ms": 4.822,
  "level": "debug",
  "msg": "",
  "rows": 0,
  "sql": "SELECT `user_id` FROM `pikpak_master_account` WHERE `pikpak_master_account`.`keepshare_user_id` <> '' AND `pikpak_master_account`.`password` <> '' AND NOT `pikpak_master_account`.`user_id` IN (SELECT `pikpak_token`.`user_id` FROM `pikpak_token`)",
  "time": "2024-04-17T16:01:18.368+08:00"
}
{
  "file": "account/token.go:53",
  "func": "account.(*Manager).queryShouldKeepAliveMasterUserIds",
  "level": "debug",
  "msg": "should login account length: 0",
  "time": "2024-04-17T16:01:18.368+08:00"
}
{
  "file": "gormutil/logger.go:97",
  "func": "gormutil.(*gormLogger).Trace",
  "latency_ms": 5.284,
  "level": "debug",
  "msg": "",
  "rows": 0,
  "sql": "SELECT * FROM `keepshare_shared_link` WHERE `state` in ('PENDING', 'CREATED') AND (`updated_at`, `auto_id`) > ('1970-01-01 00:00:00 +0000 UTC', '0') AND TIMESTAMPDIFF(SECOND, `updated_at`, NOW())*300 > TIMESTAMPDIFF(SECOND, `created_at`, `updated_at`) ORDER BY state DESC,updated_at,auto_id LIMIT 1000",
  "time": "2024-04-17T16:01:18.368+08:00"
}
{
  "file": "server/background.go:57",
  "func": "server.(*asyncBackgroundTask).getTaskFromDB",
  "level": "info",
  "msg": "current uncompleted chan length: 0, from db length: 0",
  "time": "2024-04-17T16:01:18.368+08:00"
}
{
  "file": "gormutil/logger.go:97",
  "func": "gormutil.(*gormLogger).Trace",
  "latency_ms": 0.936,
  "level": "debug",
  "msg": "",
  "rows": 0,
  "sql": "SELECT * FROM `pikpak_token` WHERE `pikpak_token`.`created_at` <= '2024-04-17 15:51:18.368' ORDER BY `pikpak_token`.`created_at` LIMIT 5000",
  "time": "2024-04-17T16:01:18.369+08:00"
}
{
  "file": "gormutil/logger.go:97",
  "func": "gormutil.(*gormLogger).Trace",
  "latency_ms": 5.823,
  "level": "debug",
  "msg": "",
  "rows": 0,
  "sql": "SELECT * FROM `pikpak_redeem_code` WHERE `pikpak_redeem_code`.`status` = 'NOT_USED' ORDER BY `pikpak_redeem_code`.`updated_at` LIMIT 1",
  "time": "2024-04-17T16:01:18.374+08:00"
}
{
  "file": "account/buffer.go:224",
  "func": "account.(*Manager).checkPremiumWorkerBuffer.func1",
  "level": "debug",
  "msg": "not used normal account: &{Zh4irXL2BooGLLsp  1fhlgm67q3mj7@mail.keepshare.org H9ZxBgalqfeh 0 6442450944 2000-01-01 00:00:00 +0800 CST 2024-04-16 15:03:09 +0800 CST 2024-04-16 15:03:09 +0800 CST 2000-01-01 00:00:00 +0800 CST }, code:<nil>",
  "time": "2024-04-17T16:01:18.374+08:00"
}
{
  "file": "gormutil/logger.go:97",
  "func": "gormutil.(*gormLogger).Trace",
  "latency_ms": 0.936,
  "level": "debug",
  "msg": "",
  "rows": 0,
  "sql": "SELECT * FROM `pikpak_file` WHERE `status` in ('PHASE_TYPE_RUNNING', 'PHASE_TYPE_PENDING') AND (`updated_at`, `auto_id`) > ('1970-01-01 00:00:00 +0000 UTC', '0') AND `created_at`>'2024-04-15 16:01:20' AND TIMESTAMPDIFF(SECOND, `updated_at`, NOW())*60 > TIMESTAMPDIFF(SECOND, `created_at`, `updated_at`) ORDER BY updated_at LIMIT 10000",
  "time": "2024-04-17T16:01:20.366+08:00"
}
{
  "file": "api/file.go:411",
  "func": "api.(*API).triggerFilesFromDB",
  "level": "debug",
  "msg": "current internal trigger chan length: 0, from db length: 0",
  "time": "2024-04-17T16:01:20.366+08:00"
}
{
  "file": "gormutil/logger.go:97",
  "func": "gormutil.(*gormLogger).Trace",
  "latency_ms": 0.982,
  "level": "debug",
  "msg": "",
  "rows": 0,
  "sql": "SELECT * FROM `pikpak_file` WHERE `pikpak_file`.`status` IN ('PHASE_TYPE_RUNNING','PHASE_TYPE_PENDING') AND `pikpak_file`.`created_at` > '2024-04-17 15:51:18.363' ORDER BY `pikpak_file`.`created_at` LIMIT 10000",
  "time": "2024-04-17T16:01:20.367+08:00"
}
{
  "file": "gormutil/logger.go:97",
  "func": "gormutil.(*gormLogger).Trace",
  "latency_ms": 0.653,
  "level": "debug",
  "msg": "",
  "rows": 0,
  "sql": "SELECT * FROM `keepshare_shared_link` WHERE `state` in ('PENDING', 'CREATED') AND (`updated_at`, `auto_id`) > ('1970-01-01 00:00:00 +0000 UTC', '0') AND TIMESTAMPDIFF(SECOND, `updated_at`, NOW())*300 > TIMESTAMPDIFF(SECOND, `created_at`, `updated_at`) ORDER BY state DESC,updated_at,auto_id LIMIT 1000",
  "time": "2024-04-17T16:01:20.369+08:00"
}
{
  "file": "server/background.go:57",
  "func": "server.(*asyncBackgroundTask).getTaskFromDB",
  "level": "info",
  "msg": "current uncompleted chan length: 0, from db length: 0",
  "time": "2024-04-17T16:01:20.369+08:00"
}
{
  "file": "gormutil/logger.go:99",
  "func": "gormutil.(*gormLogger).Trace",
  "latency_ms": 1.923,
  "level": "info",
  "msg": "",
  "rows": 0,
  "sql": "UPDATE `keepshare_shared_link` SET `state`='ERROR',`updated_at`='2024-04-17 16:01:21.365',`error`='TIMEOUT' WHERE `keepshare_shared_link`.`state` IN ('UNKNOWN','PENDING','CREATED') AND `keepshare_shared_link`.`created_at` < '2024-04-15 14:01:21.364'",
  "time": "2024-04-17T16:01:21.366+08:00"
}
{
  "file": "gormutil/logger.go:97",
  "func": "gormutil.(*gormLogger).Trace",
  "latency_ms": 0.715,
  "level": "debug",
  "msg": "",
  "rows": 0,
  "sql": "SELECT * FROM `pikpak_file` WHERE `status` in ('PHASE_TYPE_RUNNING', 'PHASE_TYPE_PENDING') AND (`updated_at`, `auto_id`) > ('1970-01-01 00:00:00 +0000 UTC', '0') AND `created_at`>'2024-04-15 16:01:22' AND TIMESTAMPDIFF(SECOND, `updated_at`, NOW())*60 > TIMESTAMPDIFF(SECOND, `created_at`, `updated_at`) ORDER BY updated_at LIMIT 10000",
  "time": "2024-04-17T16:01:22.367+08:00"
}
{
  "file": "api/file.go:411",
  "func": "api.(*API).triggerFilesFromDB",
  "level": "debug",
  "msg": "current internal trigger chan length: 0, from db length: 0",
  "time": "2024-04-17T16:01:22.367+08:00"
}
{
  "file": "gormutil/logger.go:97",
  "func": "gormutil.(*gormLogger).Trace",
  "latency_ms": 0.953,
  "level": "debug",
  "msg": "",
  "rows": 0,
  "sql": "SELECT * FROM `pikpak_file` WHERE `pikpak_file`.`status` IN ('PHASE_TYPE_RUNNING','PHASE_TYPE_PENDING') AND `pikpak_file`.`created_at` > '2024-04-17 15:51:18.363' ORDER BY `pikpak_file`.`created_at` LIMIT 10000",
  "time": "2024-04-17T16:01:22.368+08:00"
}
{
  "file": "gormutil/logger.go:97",
  "func": "gormutil.(*gormLogger).Trace",
  "latency_ms": 0.582,
  "level": "debug",
  "msg": "",
  "rows": 0,
  "sql": "SELECT * FROM `keepshare_shared_link` WHERE `state` in ('PENDING', 'CREATED') AND (`updated_at`, `auto_id`) > ('1970-01-01 00:00:00 +0000 UTC', '0') AND TIMESTAMPDIFF(SECOND, `updated_at`, NOW())*300 > TIMESTAMPDIFF(SECOND, `created_at`, `updated_at`) ORDER BY state DESC,updated_at,auto_id LIMIT 1000",
  "time": "2024-04-17T16:01:22.370+08:00"
}
{
  "file": "server/background.go:57",
  "func": "server.(*asyncBackgroundTask).getTaskFromDB",
  "level": "info",
  "msg": "current uncompleted chan length: 0, from db length: 0",
  "time": "2024-04-17T16:01:22.370+08:00"
}
